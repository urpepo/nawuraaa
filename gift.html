<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hadiah untuk Naura üéÅ ‚Äî Patched</title>
  <meta name="theme-color" content="#f6c2d1" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600;700&family=Poppins:wght@400;600;700&display=swap">
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{ --pink:#f6c2d1; --ink:#171717; --white:#fff; }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Poppins,system-ui,Segoe UI,Arial,sans-serif;color:#fff;background:radial-gradient(120% 120% at 50% 10%, #190c12, #0b0910 60%, #09090b); overflow-x:hidden}

    .wrap{min-height:100svh;display:grid;place-items:center;padding:24px}
    .stage{display:grid;gap:18px;place-items:center;text-align:center}
    h1{font-family:"Dancing Script",cursive;font-weight:700;font-size:clamp(30px,6.2vw,56px);margin:0}
    p.lead{opacity:.9;margin:.25rem 0 0;font-size:clamp(14px,2.8vw,18px)}

    /* Gift Box */
    .gift{position:relative;width:min(280px,72vw);height:min(230px,58vw);cursor:pointer;user-select:none}
    .box{position:absolute;inset:auto 0 0 0;height:66%;border-radius:12px;background:linear-gradient(180deg,#ff9ec0,#ff7aa7);box-shadow:0 18px 50px rgba(246,194,209,.25)}
    .box:before{content:"";position:absolute;left:50%;top:0;bottom:0;width:22px;background:rgba(255,255,255,.6);transform:translateX(-50%)}
    .lid{position:absolute;left:50%;bottom:66%;transform:translateX(-50%);width:110%;height:22%;background:linear-gradient(180deg,#ffb3cc,#ff8db8);border-radius:14px;transform-origin:bottom center;box-shadow:0 14px 40px rgba(246,194,209,.25)}
    .lid:before{content:"";position:absolute;left:50%;top:0;bottom:0;width:24px;background:rgba(255,255,255,.7);transform:translateX(-50%)}
    .bow{position:absolute;left:50%;bottom:70%;transform:translateX(-50%);width:70px;height:50px}
    .loop{position:absolute;width:34px;height:34px;border:10px solid #ffd7e5;border-radius:50%}
    .loop.left{right:50%;transform:translateX(-6px) rotate(15deg)}
    .loop.right{left:50%;transform:translateX(6px) rotate(-15deg)}

    /* hover wiggle */
    .gift:hover{animation:shake .6s ease-in-out infinite}
    @keyframes shake{ 0%,100%{transform:translateY(0)} 50%{transform:translateY(-2px)} }

    /* OPEN / EXPLODE state */
    .open .lid{animation:flip 760ms ease forwards}
    @keyframes flip{ 0%{ transform:translateX(-50%) rotate(0) } 60%{ transform:translateX(-50%) rotate(-85deg) } 100%{ transform:translateX(-50%) rotate(-92deg); opacity:.95 } }
    .open .box{animation:bounce 680ms ease}
    @keyframes bounce{ 0%{ transform:translateY(0) } 45%{ transform:translateY(6px) } 100%{ transform:translateY(0) } }

    .explode{animation: kaboom .68s ease forwards;}
    @keyframes kaboom{ 0%{opacity:1; transform:scale(1)} 100%{opacity:0; transform:scale(1.15)} }

    /* Voucher reveal */
    .reveal{display:none; opacity:0; transform:translateY(18px) scale(.985); transition:opacity .55s ease, transform .55s ease}
    .show{display:block; opacity:1; transform:translateY(0) scale(1)}
    .voucher{display:grid;gap:12px;place-items:center;background:linear-gradient(180deg,rgba(255,255,255,.08),rgba(255,255,255,.06));border:1px solid rgba(255,255,255,.14);border-radius:16px;padding:16px 14px;box-shadow:0 20px 60px rgba(246,194,209,.15), inset 0 1px 0 rgba(255,255,255,.15)}
    .voucher .heading{font-size:clamp(16px,3.4vw,20px);margin:.2rem 0 .1rem}
    .code{display:flex;flex-wrap:wrap;align-items:center;gap:10px;background:rgba(0,0,0,.35);border:1px dashed rgba(255,255,255,.35);padding:10px 12px;border-radius:12px}
    .code kbd{font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; font-size:16px; letter-spacing:.8px}
    .btn{appearance:none;border:none;border-radius:12px;padding:.8rem 1.05rem;font-weight:700;cursor:pointer}
    .btn.primary{background:var(--pink);color:#4b0a1b;box-shadow:0 10px 30px rgba(246,194,209,.35)}
    .btn.ghost{background:transparent;color:#fff;border:1px solid rgba(255,255,255,.35)}

    /* Confetti canvas */
    #confetti{position:fixed;inset:0;z-index:10;pointer-events:none}

    .actions{display:flex;gap:10px;justify-content:center;margin-top:8px}
  </style>
</head>
<body>
  <canvas id="confetti"></canvas>
  <main class="wrap">
    <section class="stage">
      <header>
        <h1>Hadiah Buat <span id="name">Naura</span> üéÅ</h1>
        <p class="lead">Sekali lagi.. Happy Birthdayyy nauraa ‚ú®</p>
      </header>

      <!-- GIFT BOX -->
      <div class="gift" id="gift" role="button" aria-label="Buka hadiah" onclick="openGift()">
        <div class="bow">
          <span class="loop left"></span>
          <span class="loop right"></span>
        </div>
        <div class="lid"></div>
        <div class="box"></div>
      </div>

      <!-- REVEAL AREA (TEXT CODE ONLY) -->
      <div id="reveal" class="reveal" aria-live="polite">
        <div class="voucher">
          <p class="heading">Voucher Shopee untuk <strong id="toName">Naura</strong> ‚ú®</p>
          <div class="code">
            <kbd id="codeText">NANTIDIGANTI</kbd>
            <button class="btn ghost" id="copyBtn" type="button" onclick="copyCode()">Salin Kode</button>
          </div>
          <div class="actions">
            <a class="btn primary" id="useBtn" href="https://shopee.co.id/user/voucher-wallet" target="_blank" rel="noopener">Pakai di Shopee</a>
            <a class="btn ghost" href="./lilin.html">Tiup Lilin üéÇ</a>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- optional sfx -->
  <audio id="popSfx">
    <source src="./audio/pop.mp3" type="audio/mpeg">
  </audio>

  <script>
    // ====== CONFIG ======
    var CONFIG = {
      crushName: 'Naura',
      code: 'NANTIDIGANTI',
      shopeeLink: 'https://shopee.co.id/user/voucher-wallet',
      confettiOnOpen: 420
    };

    function $(sel){ return document.querySelector(sel); }

    // ===== Confetti (simple canvas) =====
    var canvas = document.getElementById('confetti');
    var ctx = canvas.getContext('2d');
    var confetti = [];
    function resize(){ canvas.width = innerWidth; canvas.height = innerHeight; }
    function make(n){
      var colors = ['#ffffff','#fde2e7','#ffd3e1','#ffe6a7','#b8e3ff','#d4f8c4'];
      for(var i=0;i<n;i++){
        confetti.push({x: Math.random()*canvas.width, y: -10, r: Math.random()*5+2, w: Math.random()*8+4, h: Math.random()*5+3, s: Math.random()*2+1, a: Math.random()*Math.PI, v: Math.random()*2+1, c: colors[(Math.random()*colors.length)|0]});
      }
    }
    function draw(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      confetti.forEach(function(p){ p.y+=p.v; p.x += Math.sin(p.a+=0.02)*0.9; ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.a); ctx.fillStyle=p.c; if (Math.random()>.5){ ctx.fillRect(-p.w/2,-p.h/2,p.w,p.h);} else { ctx.beginPath(); ctx.arc(0,0,p.r,0,Math.PI*2); ctx.fill(); } ctx.restore(); });
      confetti = confetti.filter(function(p){ return p.y < canvas.height+20; });
      requestAnimationFrame(draw);
    }
    function burst(n){ make(n); make(Math.floor(n*0.35)); }

    // ===== Copy Code (robust with fallback) =====
    function copyCode(){
      var textEl = document.getElementById('codeText');
      var btn = document.getElementById('copyBtn');
      var text = (textEl && (textEl.innerText || textEl.textContent)) || '';

      if (navigator.clipboard && window.isSecureContext) {
        navigator.clipboard.writeText(text).then(setCopied, fallbackCopy);
      } else {
        fallbackCopy();
      }

      function fallbackCopy(){
        var ta = document.createElement('textarea');
        ta.value = text;
        ta.setAttribute('readonly','');
        ta.style.position = 'fixed';
        ta.style.top = '-1000px';
        ta.style.opacity = '0';
        document.body.appendChild(ta);
        ta.focus();
        ta.select();
        var ok = false;
        try { ok = document.execCommand('copy'); } catch(e){ ok = false; }
        document.body.removeChild(ta);
        if (ok) setCopied(); else alert('Gagal menyalin. Salin manual: ' + text);
      }

      function setCopied(){
        if (!btn) return;
        var old = btn.textContent;
        btn.textContent = 'Tersalin!';
        btn.disabled = true;
        setTimeout(function(){ btn.textContent = old; btn.disabled = false; }, 1600);
      }
    }
    window.copyCode = copyCode; // expose globally

    // ===== Gift open / reveal =====
    function openGift(){
      var gift = $('#gift');
      if (!gift || gift.classList.contains('open')) return;
      gift.classList.add('open');
      var sfx = document.getElementById('popSfx');
      if (sfx && sfx.play) { try { sfx.play(); } catch(e){} }
      burst(CONFIG.confettiOnOpen);
      gift.classList.add('explode');
    }
    window.openGift = openGift; // expose globally

    function bindRevealOnLidFlip(){
      var lid = document.querySelector('.lid');
      if(!lid) return;
      lid.addEventListener('animationend', function(ev){
        if(ev.animationName === 'flip'){
          var reveal = $('#reveal');
          reveal.classList.add('show');
          reveal.scrollIntoView({behavior:'smooth', block:'center'});
          setTimeout(function(){ var g = $('#gift'); if(g) g.style.visibility='hidden'; }, 200);
        }
      });
    }

    function init(){
      resize();
      requestAnimationFrame(draw);
      $('#name').textContent = CONFIG.crushName;
      $('#toName').textContent = CONFIG.crushName;
      $('#codeText').textContent = CONFIG.code;
      $('#useBtn').href = CONFIG.shopeeLink;
      $('#gift').addEventListener('click', openGift);
      bindRevealOnLidFlip();
      addEventListener('resize', resize);
    }
    if (document.readyState === 'loading'){ document.addEventListener('DOMContentLoaded', init); } else { init(); }
  </script>
</body>
</html>

